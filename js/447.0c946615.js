"use strict";(self["webpackChunkariamin"]=self["webpackChunkariamin"]||[]).push([[447],{7447:(e,a,l)=>{l.r(a),l.d(a,{default:()=>Z});l(71),l(5363);var t=l(3673),n=l(1959),d=l(2323),o=l(8880),r=l(3001);l(8452),l(4685);const i={class:"column scroll",style:{flex:"1"}},s=(0,t._)("div",{class:"row",style:{height:"52px"}},null,-1),c={key:4,class:"col-12 q-mt-sm"},u=["src"],m={key:5},p={class:"row"},g={key:6,class:"column"},b={class:"row justify-center"},w=["src"],f={class:"column"},y={setup(e){const{methods:a,state:y}=r.Z,S=(0,t.RC)((()=>Promise.all([l.e(736),l.e(453)]).then(l.bind(l,8453)))),k=(0,t.RC)((()=>Promise.all([l.e(736),l.e(531)]).then(l.bind(l,1531)))),U=(0,t.RC)((()=>Promise.all([l.e(736),l.e(344)]).then(l.bind(l,7344)))),C=(0,t.RC)((()=>l.e(234).then(l.bind(l,1234)))),h=(0,t.RC)((()=>Promise.all([l.e(736),l.e(506)]).then(l.bind(l,5506)))),_=(0,t.RC)((()=>l.e(609).then(l.bind(l,7388)))),v=(0,t.RC)((()=>Promise.all([l.e(736),l.e(415)]).then(l.bind(l,9415)))),q={0:{name:"Save",func:()=>a.update([["step",1]]),moreFunc:()=>{a.update([["moreInfo",[{icon:"delete",name:"Delete Delivered Prescription",color:"negative",func:()=>{a.dlgConf({title:"Delete Prescription",type:"delete"})}}]]]),a.dlgConf({type:"moreinfo"})}},1:{name:"Add",func:()=>a.dlgConf({title:"Medicine Search",type:"addmed"}),moreFunc:()=>{a.update([["moreInfo",[{name:"Print Prescriotion Order",icon:"print",href:"data:application/pdf;base64,"+y.pdfBase64,title:y.samadCode}]]]),a.dlgConf({type:"moreinfo"})}}},W=(0,n.iH)(null);(0,t.bv)((()=>{let e=localStorage.getItem("salamat-cred");localStorage.getItem("tamin-cred");e||a.dlgConf({step:2,title:"Salamat Login",type:"sign"}),a.getInitial()}));const I=(0,n.Fl)((()=>{let e={};for(const a of y.medCart)a.bulkId?(e.hasOwnProperty(a.bulkId)||(e[a.bulkId]=[]),e[a.bulkId].push(a)):(e.hasOwnProperty("brand")||(e["brand"]=[]),e["brand"].push(a));return e})),x=async()=>{2===y.dialogStep&&a.insuranceApi("getAgent"),3===y.dialogStep&&a.insuranceApi("getAgentOtp")},D=e=>{W.value.validate().then((e=>{e&&a.insuranceApi("barcode",[{barcode:y.barcode,count:y.ordCount}]).then((()=>a.update([["ordCount",null],["barcode",null]])))}))},P=async()=>{console.log(y.medCart),a.insuranceApi("delPresc")},F=(0,n.Fl)((()=>{let e={total:0,insurance:0,payable:0};return y.medCart.filter((e=>e.remainCount&&e.allowed)).forEach((a=>{e.total+=a.price.total,e.insurance+=a.price.orgTotal,e.payable+=a.price.payable})),e}));return(e,l)=>{const r=(0,t.up)("q-item-label"),Z=(0,t.up)("q-btn"),j=(0,t.up)("q-badge"),Q=(0,t.up)("q-avatar"),A=(0,t.up)("q-item-section"),T=(0,t.up)("q-item"),O=(0,t.up)("q-list"),L=(0,t.up)("q-icon"),z=(0,t.up)("q-input"),H=(0,t.up)("q-form"),R=(0,t.up)("StackedSpan"),K=(0,t.up)("AriaLayout"),Y=(0,t.up)("q-page");return(0,t.wg)(),(0,t.j4)(Y,{class:"column"},{default:(0,t.w5)((()=>[(0,t.Wm)(K,{moreinfo:q[(0,n.SU)(y).step],onOnDialogHide:l[8]||(l[8]=e=>((0,n.SU)(a).dlgConf,(0,n.SU)(a).update([["search",""]])))},{step0:(0,t.w5)((()=>[(0,t.Wm)((0,n.SU)(S))])),step1:(0,t.w5)((()=>[(0,t._)("div",i,[(0,t.wy)((0,t.Wm)(r,{header:""},{default:(0,t.w5)((()=>[(0,t.Uk)((0,d.zw)(`${(0,n.SU)(y).medCart.length} items`),1)])),_:1},512),[[o.F8,(0,n.SU)(y).medCart.length]]),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(Object.keys((0,n.SU)(I)),((e,a)=>((0,t.wg)(),(0,t.iD)("div",{key:a},[(0,t.wy)((0,t._)("div",{class:"row q-ml-sm text-body1 items-center lineAfter"}," Group - "+(0,d.zw)(e),513),[[o.F8,"brand"!==e]]),(0,t._)("div",{class:(0,d.C_)(["column rounded-borders q-mb-sm q-mx-xs","brand"!==e?"bckgrd3":""])},[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)((0,n.SU)(I)[e],((e,a)=>((0,t.wg)(),(0,t.iD)("div",{key:a},[(0,t.Wm)((0,n.SU)(_),{item:e,index:a},null,8,["item","index"])])))),128))],2)])))),128)),s]),(0,t.Wm)((0,n.SU)(C),{class:"fixed-bottom",priceData:(0,n.SU)(F)},{default:(0,t.w5)((()=>[(0,t.Wm)(Z,{unelevated:"","no-caps":"",class:"q-mx-sm bckgrd txt",label:"Pay",onClick:P})])),_:1},8,["priceData"])])),dlg:(0,t.w5)((()=>["sign"===(0,n.SU)(y).dialogType?((0,t.wg)(),(0,t.j4)((0,n.SU)(U),{key:0,onOnSign:l[0]||(l[0]=e=>x())})):(0,t.kq)("",!0),"qr"===(0,n.SU)(y).dialogType?((0,t.wg)(),(0,t.j4)((0,n.SU)(k),{key:1,onOnSuccess:l[1]||(l[1]=e=>(0,n.SU)(a).update([["dialogType","barcode"],["barcode",e.barcode]]))})):(0,t.kq)("",!0),"addmed"===(0,n.SU)(y).dialogType?((0,t.wg)(),(0,t.j4)((0,n.SU)(h),{key:2})):(0,t.kq)("",!0),"delete"===(0,n.SU)(y).dialogType?((0,t.wg)(),(0,t.j4)((0,n.SU)(v),{key:3})):(0,t.kq)("",!0),(0,n.SU)(y).searchList.length&&null===(0,n.SU)(y).searchItem?((0,t.wg)(),(0,t.iD)("div",c,[(0,t.Wm)(O,{bordered:"",separator:"",class:"rounded-borders scroll",style:{"max-height":"60vh"}},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)((0,n.SU)(y).searchList,((e,a)=>((0,t.wg)(),(0,t.j4)(T,{clickable:!!e["func"],class:(0,d.C_)(["q-px-sm","state"in e?e.state?"bg-green-1":"bg-red-1":""]),key:a,onClick:a=>e.func()},{default:(0,t.w5)((()=>[(0,t.wy)((0,t.Wm)(A,{avatar:""},{default:(0,t.w5)((()=>[(0,t.Wm)(Q,null,{default:(0,t.w5)((()=>[(0,t.wy)((0,t._)("img",{src:e.image,alt:""},null,8,u),[[o.F8,"image"in e]]),(0,t.wy)((0,t.Wm)(j,{color:"primary",class:"text-uppercase",label:e.badge},null,8,["label"]),[[o.F8,"badge"in e]])])),_:2},1024)])),_:2},1536),[[o.F8,["image","badge"].some((a=>e.hasOwnProperty(a)))]]),(0,t.Wm)(A,null,{default:(0,t.w5)((()=>[(0,t.Wm)(r,{lines:"2"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,d.zw)(e.title),1)])),_:2},1024),(0,t.wy)((0,t.Wm)(r,{caption:"",lines:"1"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,d.zw)(e.caption),1)])),_:2},1536),[[o.F8,!!e["caption"]]])])),_:2},1024),(0,t.Wm)(A,{side:""},{default:(0,t.w5)((()=>[(0,t.Wm)(r,{class:"text-caption"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,d.zw)(e.side),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["clickable","class","onClick"])))),128))])),_:1})])):(0,t.kq)("",!0),"barcode"===(0,n.SU)(y).dialogType?((0,t.wg)(),(0,t.iD)("div",m,[(0,t.Wm)(H,{class:"row q-col-gutter-sm",ref_key:"barcodeForm",ref:W,onSubmit:l[7]||(l[7]=(0,o.iM)((()=>{}),["prevent"]))},{default:(0,t.w5)((()=>[(0,t.Wm)(z,{outlined:"",dense:"",autofocus:"",class:"col-8",label:"GTIN",type:"tel",rules:[e=>!!e&&e>=8||"Invalid barcode"],"model-value":(0,n.SU)(y).barcode,"onUpdate:modelValue":l[3]||(l[3]=e=>(0,n.SU)(a).update([["barcode",e.replace(/\s/g,"")]]))},{append:(0,t.w5)((()=>[(0,t.Wm)(L,{name:"qr_code_scanner",onClick:l[2]||(l[2]=e=>(0,n.SU)(a).update([["dialogType","qr","set"]]))})])),_:1},8,["rules","model-value"]),(0,t.Wm)(z,{outlined:"",dense:"",class:"col-4",label:"Count",type:"tel",mask:"###########",rules:[e=>!!e||"Invalid Count"],"model-value":(0,n.SU)(y).ordCount,"onUpdate:modelValue":l[5]||(l[5]=e=>(0,n.SU)(a).update([["ordCount",parseInt(e)]])),onKeypress:l[6]||(l[6]=(0,o.D2)((e=>D((0,n.SU)(y).barcodeList.length)),["enter"]))},{append:(0,t.w5)((()=>[(0,t.Wm)(L,{name:"send",onClick:l[4]||(l[4]=e=>D((0,n.SU)(y).barcodeList.length))})])),_:1},8,["rules","model-value"])])),_:1},512),(0,n.SU)(y).medCart[(0,n.SU)(y).medIndex].barcodes.length?((0,t.wg)(),(0,t.j4)(O,{key:0},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)((0,n.SU)(y).medCart[(0,n.SU)(y).medIndex].barcodes,((e,l)=>((0,t.wg)(),(0,t.j4)(T,{key:l},{default:(0,t.w5)((()=>[(0,t.Wm)(A,null,{default:(0,t.w5)((()=>[(0,t.Wm)(r,null,{default:(0,t.w5)((()=>[(0,t.Wm)(j,{rounded:"",color:e.status},null,8,["color"]),(0,t.Uk)(" "+(0,d.zw)(`${e.barcode} - (${e.count})`),1)])),_:2},1024)])),_:2},1024),(0,t.Wm)(A,{side:""},{default:(0,t.w5)((()=>[(0,t._)("div",p,[(0,t.Wm)(Z,{flat:"",round:"",dense:"",icon:"edit",onClick:t=>(0,n.SU)(a).update([["barcode",e.barcode],["ordCount",e.count],[`medCart[${(0,n.SU)(y).medIndex}].barcodes`,l,"rm"]])},null,8,["onClick"]),(0,t.Wm)(Z,{flat:"",round:"",dense:"",icon:"delete",color:"negative",onClick:e=>(0,n.SU)(a).update([[`medCart[${(0,n.SU)(y).medIndex}].barcodes`,l,"rm"]])},null,8,["onClick"])])])),_:2},1024)])),_:2},1024)))),128))])),_:1})):(0,t.kq)("",!0)])):(0,t.kq)("",!0),"userinfo"===(0,n.SU)(y).dialogType?((0,t.wg)(),(0,t.iD)("div",g,[(0,t._)("div",b,[(0,t.Wm)(Q,{size:"120px",style:{border:"1px dashed grey"}},{default:(0,t.w5)((()=>[(0,t._)("img",{class:"q-pa-sm",src:(0,n.SU)(y).patImage,alt:"#"},null,8,w)])),_:1})]),(0,t._)("div",f,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)((0,n.SU)(y).patInfoUI,((e,a,l)=>((0,t.wg)(),(0,t.j4)(R,(0,t.dG)({key:l},{head:a,body:e.toString(),textStyle:["text-subtitle"]}),null,16)))),128))])])):(0,t.kq)("",!0)])),_:1},8,["moreinfo"])])),_:1})}}};var S=l(4379),k=l(2350),U=l(8240),C=l(7011),h=l(3414),_=l(2035),v=l(5096),q=l(9721),W=l(5269),I=l(4689),x=l(4554),D=l(7518),P=l.n(D);const F=y,Z=F;P()(y,"components",{QPage:S.Z,QItemLabel:k.Z,QBtn:U.Z,QList:C.Z,QItem:h.Z,QItemSection:_.Z,QAvatar:v.Z,QBadge:q.Z,QForm:W.Z,QInput:I.Z,QIcon:x.Z})}}]);